<!DOCTYPE html>
<html>
   <head>
      <meta name="viewport" content="width=device-width,
         maximum-scale=0.9,user-scalable=0">
      <meta charset="UTF-8">
      <title>Data Viewer</title>
      <link rel="stylesheet" href="styles.css"/>
   </head>
   <body>
        <h1>Data Viewer</h1>
        <div id="chartContainer"></div>
        <div id="container"></div>
        <script src='../common/js_objects/features.js';></script>
        <script src='../common/constants.js';></script>
        <script src='../common/utils.js';></script>
        <script src= "js/display.js"></script>
        <script src= "https://www.gstatic.com/charts/loader.js";></script>

        <script>
            const {samples, featureNames} = features;
            const groups=utils.groupBy(samples,"session_id");

            for(let session_id in groups){
               const samples=groups[session_id];
               const userName=samples[0].user_name;
               createRow(container, userName, samples);
            }

            const options={
               width:400,
               height:400,
               hAxis:{title:featureNames[0]},
               vAxis:{title:featureNames[1]},
               legent:{position:'none'},
               explorer:{
                  maxZoomIn:0.01,
                  actions:['dragToZoom', 'rightClickToReset']}
            }

            google.charts.load('current',
               {'packages' :['corechart']}
            );

            google.charts.setOnLoadCallback(()=>{
               const data=new google.visualization.DataTable();
               data.addColumn('number', featureNames[0]);
               data.addColumn('number', featureNames[1]);
               data.addColumn({'type':'string','role':'style'});
               data.addRows(samples.map(s=>[
                  ...s.point,
                  utils.styles[s.label]
               ]));

               const chart=new google.visualization.ScatterChart(chartContainer);
               chart.draw(data,options);
            });
        </script>
   </body>
</html>